### 初步认识数据库系统

表(Table)的构成及其常用术语：

- 表名和表标题（格式）合称为（关系）模式。
- （关系）模式和表的内容（值）合称为表/关系。
- 行/元组/记录（row/tuple/record）
- 列/字段/属性/数据项（column/field/attribute/data item）

数据库：相互之间有关联关系的若干个表的集合。

数据库系统是一种工作环境，其有五个构成要素：

- 数据库（DB，Database）：相互有关联关系的数据的集合
- 数据库管理系统（DBMS，Database Management System）：管理数据库的一种系统软件
- 数据库应用（DBAP，Database Application）：用户直接使用的应用程序，其通过数据库管理系统来操作数据库
- 数据库管理员（DBA，Database Administration）：直接操作数据库管理系统
- 计算机基本系统：数据库系统的实现环境

数据库系统的例子如下图所示：图书管理数据库系统。

![图书管理数据库系统](http://book.moecode.com/db/p1/1.png)

从**用户**的角度看：数据库管理系统需要有哪些功能呢？

- 数据库定义功能：定义数据库中Table的名称、标题（内含的属性名称以及对该属性的值的要求）等。

  DBMS给用户提供一套数据定义语言（DDL：Data Definition Language），用户用其来描述所要建立的表的格式，DBMS则按照用户的定义来创建数据库。

- 数据库操纵功能：向数据库的Table中增加/删除/更新数据以及对数据进行查询、检索、统计等。

  DBMS给用户提供一套数据操纵语言（DML：Data Manipulation Language），用户使用DML描述其所要进行的增、删、改、查等操作，DBMS则依照用户的操作描述来实际执行这些操作。

- 数据库控制功能：控制数据库中数据的使用，权限的控制。

  DBMS提供一套数据控制语言（DCL：Data Control Language），用户使用DCL描述控制。

- 数据库维护功能：转储、恢复、重组、性能监测、分析……

  一般是由DBA来掌握和使用的。

上述的DDL、DML、DCL构成SQL语言：结构化的数据库语言。

数据库语言和高级语言的关系：一条数据库语言语句相当于高级语言的一个或多个循环程序；数据库语言可以嵌入到高级语言（宿主语言）中使用，成为嵌入式数据库语言，比如在数据库应用程序开发的场景中。

从**系统**的角度，DBMS为了完成DB的管理，在后台运行着一系列的程序：

- 语言编译器：将用数据库语言书写的内容翻译成DBMS可执行的命令，比如DDL/DML/DCL编译器。
- 查询优化（执行引擎）与查询实现（基本命令的不同执行算法）：提高数据库检索速度的手段，比如贯穿于数据存取各个阶段的优化程序。
- 数据存储与索引：提供数据在磁盘、磁带上的高效存取手段，比如存储管理器、缓冲区管理器、索引/文件和记录管理器。
- 通信控制：提供网络环境下数据库操作与数据传输的手段。
- 事务管理程序
- ……

![数据库管理系统小结](http://book.moecode.com/db/p1/2.png)



### 数据库系统的标准结构

DBMS管理数据有三个层次，这是数据库系统的分层抽象：

- External Level = User Level：某一用户能够看到与处理的数据，其为全局数据中的某一部分。
- Conceptual Level = Logic Level：从全局角度理解和管理数据，含有相应的关联约束。
- Internal Level = Physical Level：存储在介质上的数据，含存储路径、存储方式、索引方式等。

![三个层次示意图](http://book.moecode.com/db/p1/3.png)

两个重要的概念如下所示。直观来看模式就是表头，视图就是表的内容。

- 模式（Schema）：对数据库中数据所进行的一种结构性的描述，所观察到的数据的结构信息，实际上是数据的抽象。
- 视图（View）/数据（Data）：某一种表现形式下表现出来的数据库中的数据。

由数据库系统的分层抽象和模式/视图的概念可以得到三级模式（三级视图）的概念：

- External Schema 对应 External View
- Conceptual Schema 对应 Conceptual View
- Internal Schema 对应 Internal View

三级模式由两层映像连接起来：

- E-C Mapping：将外模式映射为概念模式，从而支持实现数据概念视图向外部视图的转换，便于用户观察和使用。
- C-I Mapping：将概念模式映射为内模式，从而支持实现数据概念视图向内部视图的转换。

三级模式和两层映像是数据库的标准结构。DBMS最主要的是让用户定义三级模式，通过程序自动实现两层映像。

为什么要按照标准结构进行数据库系统的抽象呢？为的是保证两个独立性从而使得用户应用程序不必反复修改。

- 逻辑数据独立性：当概念模式发生变化时，可以不改变外部模式，只需改变E-C映像，从而无需改变应用程序。
- 物理数据独立性：当内部模式发生变化时，可以不改变概念模式，只需改变C-I映像，从而不改变外部模式，进而不改变应用程序。



### 数据模型

首先要了解数据模型的概念。在数据库基本概念中提到的“模式”是对数据本身结构形式的抽象，而数据模型是对模式本身结构的抽象。可以说“数据模型是数据的结构的结构”。

数据模型规定“模式”统一描述方式的模型，包括三要素：数据结构、操作、约束。

比如关系模型就是一种数据模型，所有模式都可为抽象表的形式（数据结构），而每一个具体的模式都是拥有不同列名的具体的表，对具体的表这样一种数据有不同的“操作”和“约束”。

如下图所示是数据模型和模式的相对关系示意图。

![数据模型和模式](http://book.moecode.com/db/p1/4.png)

三大经典的数据模型：

- 关系模型：**表**的形式组织数据
- 层次模型：**树**的形式组织数据
- 网状模型：**图**的形式组织数据



### 数据库系统的演变与发展

- 第一阶段：数据库技术探索阶段

  提出Data Base

- 第二阶段：数据库技术确立阶段

  三大数据模型相继提出并进行深入研究

  商用数据库系统出现并应用，但是多为网状及层次型系统

  数据库研究形成理论基础：关系型数据库理论

- 第三阶段：数据库技术成熟阶段（76 ～ 80s前期）

  提出标准化数据库系统结构模型（三级模式两层映像）

  关系DB系统迅速发展，关系理论日臻完善，数据库应用十分普及

- 第四阶段：数据库技术深化发展阶段（85以来）

  数据库方法逐步理论化、数据库设计理论不断完善

  新型数据模型、专用数据模型，专用/新型数据库系统不断涌现

  数据库技术与其他计算机技术结合

几个重大发展：

- 由文件系统发展到数据库：文件是操作系统的概念。

  文件系统的优点是用户不必考虑文件存储的物理细节，解脱了对物理设备存取复杂性处理的负担。

  缺点是数据和程序紧密结合（数据的组织以及语义紧密依赖于处理该文件的应用程序），数据结构发生改变则必须修改应用程序，文件之间没有联系，文件的记录之间没有联系，共享性差，冗余度大，不一致性比较高。

  为了使数据和应用程序之间有较强的独立性，也就是前面提到的数据的物理独立性和逻辑独立性，发展出了数据库系统。

  DBMS统一存取、维护数据组织形式及语义，可以较强地独立于应用程序；数据和数据结构的定义和描述被从应用程序中分离出去，交给DBMS，使得多个应用程序可以共享数据及数据结构的操作；有统一的数据控制功能，数据的共享度高；整体数据结构化，表之间、记录之间相互有关联，数据冗余度小容易扩充；还有独立于应用程序的高效率查询和统计操作。

- 由层次/网状模型数据库到关系型数据库：前二者被称为第一代数据库，后者被称为第二代数据库。

  第一代数据库的特点是数据之间的关联关系由复杂的指针系统来维系，结构的描述比较复杂；数据检索的操作依赖于由指针系统指示的路径；指针系统的特点使得其只能逐一操作记录，不能有效支持记录集合的操作。

  关系型数据库中数据之间关联关系由表中的属性的值来表征，结构描述比较简单；数据的检索操作不依赖于路径信息或者过程信息，支持非过程化的数据操作；能够有效支持记录集合的操作（比如对某性别对应的子集进行查询）；有较为完善的理论基础。

  关系型数据库彻底消除了指针，不用让用户去建立指针，这是很大的一个进步。

- 由关系数据库到对象关系数据库、面向对象数据库。

  关系型数据库必须以按行按列的形式组织数据：关系的第一范式。关系的第一范式指的是数据项的不可再分的特性，也就是说数据项不能是一个集合，比如地址项就只能是一个完整的地址，而不能是省份、城市、街道等的组合。这可以说是关系型数据库的一个缺点。

  关系的第一范式这种约束会对用户带来一定的不便，比如数据中可能会有不满足第一范式的情况。比如姓名分成姓和名，这称为**复合属性**；又比如一个人可能对应某个字段的多个值（比如一个人多门课程），这称为**多值属性**。

  对象-关系数据库能够有效支持不满足关系第一范式的数据项，以对象来封装需要分解的数据项。引入了行对象和列对象（一行就是一个行对象）；结构对象和聚集对象（复合属性对应结构对象；多值属性对应聚集对象）。

  面向对象数据库是面向对象技术和集合/聚集操作技术的结合，能够支持复杂的数据类型，有数据封装和抽象数据结构的概念，支持面向对象的一些特性：类、继承、封装、多态。

  ![XML数据库](http://book.moecode.com/db/p1/5.png)

- 由多种多样的数据库到多数据库开放式互联。

  有多种DBMS，比如设计一个图书管理系统，财务系统用Ingres，业务系统用Oracle（虽然最好的情况是都用统一的系统），这样就必须考虑多个数据库的互联。

  在应用程序和DBMS之间有一个接口叫做Open DateBase Connection（ODBC），应用程序员只需针对ODBC进行应用程序的设计，而有ODBC与不同的DBMS进行交互。如下图所示：

  ![ODBC](http://book.moecode.com/db/p1/6.png)

- 由普通数据库到与各种先进技术结合所形成的新型数据库。如下图所示：

  ![新型数据库](http://book.moecode.com/db/p1/7.png)

概念小结如下图所示：

![概念小结](http://book.moecode.com/db/p1/8.png)